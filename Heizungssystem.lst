RC51 COMPILER V03.08.10.309,  HEIZUNGSSYSTEM     09/20/21  10:50:53  PAGE  1

QCW(0x00002F32)

DOS RC51 COMPILER V03.08.10.309, COMPILATION OF MODULE HEIZUNGSSYSTEM
OBJECT MODULE PLACED IN E:\Microcontroller_C\Smart Home\Heizungssystem.obj
COMPILER INVOKED BY: QUIET GENERATEDEPFILE OJ(E:\Microcontroller_C\Smart Home\He
            -izungssystem.obj) PIN(C:\Raisonance\Ride\Inc;C:\Raisonance\Ride\Inc
            -\51) PIN(C:\Raisonance\Ride\\inc\51\SiLabs) NOAM CD PR(E:\Microcont
            -roller_C\Smart Home\Heizungssystem.lst) FP(NOFLOAT) IP NOIS UNSIGNE
            -DCHAR ET(CHAR) PR PL(60) PW(80) OE(1) OT(7,SPEED) RB(0) MAXERR(25) 
            -MAXWAR(25) SM MOD517(NODP8,NOAU) 

stmt level    source
   1          /*
   2           Name:          Tim Schlachter / Anton Tran
   3           Klasse.        TG13/3
   4           Datum:         20.09.2021
   5           Aufgabe:   	Heizungssystem
   6           Controller:    C8051F340
   7           */
   8          
   9           //---------------------------------------------------------------
            ---------------
  10           // Include Dateien
  11           //---------------------------------------------------------------
            ---------------
  12          #include <stdio.h>									// für sprinf		
  13          #include <C_8051F340.h>                //Erweiterte SFR Zuordnunge
            -n
  14          #include <Einstellungen.h>             //beinhaltet die Funktion G
            -rundeinstellungen
  15          
  16          //----------------------------------------------------------------
            --------------
  17          // Pin/Port Zuweisungen
  18          //----------------------------------------------------------------
            --------------
  19          unsigned char buf [20] ;	        // Zwischenspeicher für LCD-Text
  20          unsigned char systemStatus = 1;     // Systemstatus: 1 -> an, 0 ->
            - aus
  21          double step = 0.5;                  // Schrittgrösse
  22          double currentTemp = 21;            // Derzeitige Temperatur 
  23          double selectedTemp = 21;           // Ausgewählte Temperatur 
  24          double minTemp = 15;                // Untere Temperaturgrenze
  25          double maxTemp = 30;                // Obere Temperaturgrenze
  26          
  27          //----------------------------------------------------------------
            --------------
  28          // Eigene Funktionen
  29          //----------------------------------------------------------------
            --------------
  30          
  31          // externe Funktionen in lcd.c; Diese Datei zum Projekt hinzufügen
            -
  32          extern void initlcd (void);						//	Initialisierung LCD-Display an
            - P0			
  33          extern void loeschenlcd (void);
  34          extern void textlcd (unsigned char *text,unsigned char zeile);
  35          
  36          void init(void)
RC51 COMPILER V03.08.10.309,  HEIZUNGSSYSTEM     09/20/21  10:50:53  PAGE  2

  37          {
  38   1      	selectedTemp = 21;
  39   1      }
  40          
  41          void ausgabe(void)
  42          {
  43   1          //LCD Display
  44   1          sprintf (buf,"Derzeitige Temperatur: %d°",currentTemp);
  45   1      	// Text mit Variable formatieren und in buf kopieren		
  46   1      	//	% Ausgabeformat folgt, d Dezimalzahl mit Vorzeichen, a auszuge
            -bende Variable	
  47   1      	textlcd (buf,1);
  48   1          sprintf (buf,"Sollwert: %d°",selectedTemp);
  49   1        	textlcd (buf,2);
  50   1      }
  51          
  52          //----------------------------------------------------------------
            --------------
  53          // Hauptprogramm
  54          //----------------------------------------------------------------
            --------------
  55          void main(void)
  56          {
  57   1      	Grundeinstellungen();		    //siehe Datei Einstellungen.h
  58   1          initlcd ();						//	Initialisierung LCD-Display an P3
  59   1       	loeschenlcd ();				    //	Anzeige löschen	
  60   1          init();
  61   1      
  62   1      	while (1)
  63   1      	{
  64   2      		ausgabe();
  65   2      
  66   2      		if (!P3_1)				//Plus
  67   2      		{
  68   3                  if (selectedTemp <= (maxTemp - step))
  69   3                  {
  70   4                      selectedTemp += step;
  71   4                  }
  72   3      			while (!P3_1);		//Warten bis Taster losgelassen
  73   3      		}
  74   2      
  75   2      		if (!P3_2)				//Minus
  76   2      		{
  77   3      			if (selectedTemp >= (minTemp + step))
  78   3                  {
  79   4                      selectedTemp -= step;
  80   4                  }
  81   3      			while (!P3_2);		//Warten bis Taster losgelassen
  82   3      		}
  83   2          
  84   2          
  85   2              // An / Aus
  86   2              if (!P3_3)
  87   2              {
  88   3                 systemStatus = !systemStatus; 
  89   3                 while (!P3_3);		//Warten bis Taster losgelassen
  90   3              }
  91   2      	}
RC51 COMPILER V03.08.10.309,  HEIZUNGSSYSTEM     09/20/21  10:50:53  PAGE  4

  92   1      }
RC51 COMPILER V03.08.10.309,  HEIZUNGSSYSTEM     09/20/21  10:50:53  PAGE  7

ASSEMBLY LISTING OF GENERATED OBJECT CODE

            ; FUNCTION Grundeinstellungen (BEGIN)
                                           ; SOURCE LINE # 9 
0000 75B283         MOV    OSCICN,#083H
                                           ; SOURCE LINE # 11 
0003 75D900         MOV    PCA0MD,#000H
                                           ; SOURCE LINE # 17 
0006 75A4FF         MOV    P0MDOUT,#0FFH
                                           ; SOURCE LINE # 18 
0009 75A5FF         MOV    P1MDOUT,#0FFH
                                           ; SOURCE LINE # 19 
000C 75A6FF         MOV    P2MDOUT,#0FFH
                                           ; SOURCE LINE # 20 
000F 75A7FF         MOV    P3MDOUT,#0FFH
                                           ; SOURCE LINE # 21 
0012 75AEFF         MOV    P4MDOUT,#0FFH
                                           ; SOURCE LINE # 24 
0015 75E240         MOV    XBR1,#040H
                                           ; SOURCE LINE # 14 
0018 22             RET    

            ; FUNCTION Grundeinstellungen (END)

            ; FUNCTION init (BEGIN)
                                           ; SOURCE LINE # 38 
0000 E4             CLR    A
0001 F500    R      MOV    selectedTemp,A
0003 F500    R      MOV    selectedTemp+01H,A
0005 7500A8  R      MOV    selectedTemp+02H,#0A8H
0008 750041  R      MOV    selectedTemp+03H,#041H
                                           ; SOURCE LINE # 39 
000B 22             RET    

            ; FUNCTION init (END)

            ; FUNCTION ausgabe (BEGIN)
                                           ; SOURCE LINE # 44 
0000 C000    R      PUSH   currentTemp
0002 C000    R      PUSH   currentTemp+01H
0004 C000    R      PUSH   currentTemp+02H
0006 C000    R      PUSH   currentTemp+03H
0008 7B01           MOV    R3,#001H
000A E4             CLR    A
000B FA             MOV    R2,A
000C 7900    R      MOV    R1,#buf
000E 7D05           MOV    R5,#005H
0010 7C00    R      MOV    R4,#HIGH(?STR?HEIZUNGSSYSTEM?BASE)
0012 7800    R      MOV    R0,#LOW(?STR?HEIZUNGSSYSTEM?BASE)
0014 120000  R      LCALL  ?sprintf
0017 74FC           MOV    A,#0FCH
0019 2581           ADD    A,SP
001B F581           MOV    SP,A
                                           ; SOURCE LINE # 47 
001D 7B01           MOV    R3,#001H
001F 7900    R      MOV    R1,#buf
0021 E4             CLR    A
0022 FA             MOV    R2,A
0023 7D01           MOV    R5,#001H
0025 120000  R      LCALL  _textlcd
RC51 COMPILER V03.08.10.309,  HEIZUNGSSYSTEM     09/20/21  10:50:53  PAGE  3

                                           ; SOURCE LINE # 48 
0028 C000    R      PUSH   selectedTemp
002A C000    R      PUSH   selectedTemp+01H
002C C000    R      PUSH   selectedTemp+02H
002E C000    R      PUSH   selectedTemp+03H
0030 7B01           MOV    R3,#001H
0032 7900    R      MOV    R1,#buf
0034 E4             CLR    A
0035 FA             MOV    R2,A
0036 7D05           MOV    R5,#005H
0038 7C00    R      MOV    R4,#HIGH(?STR?HEIZUNGSSYSTEM?BASE + 01BH)
003A 7800    R      MOV    R0,#LOW(?STR?HEIZUNGSSYSTEM?BASE + 01BH)
003C 120000  R      LCALL  ?sprintf
003F 74FC           MOV    A,#0FCH
0041 2581           ADD    A,SP
0043 F581           MOV    SP,A
                                           ; SOURCE LINE # 49 
0045 7B01           MOV    R3,#001H
0047 7900    R      MOV    R1,#buf
0049 E4             CLR    A
004A FA             MOV    R2,A
004B 7D02           MOV    R5,#002H
004D 020000  R      LJMP   _textlcd

            ; FUNCTION ausgabe (END)

            ; FUNCTION main (BEGIN)
                                           ; SOURCE LINE # 57 
0000 120000  R      LCALL  Grundeinstellungen
                                           ; SOURCE LINE # 58 
0003 120000  R      LCALL  initlcd
                                           ; SOURCE LINE # 59 
0006 120000  R      LCALL  loeschenlcd
                                           ; SOURCE LINE # 60 
0009 120000  R      LCALL  init
000C         ?WHILE4:
                                           ; SOURCE LINE # 64 
000C 120000  R      LCALL  ausgabe
                                           ; SOURCE LINE # 66 
000F 20B141         JB     P3_1,?NXT10
                                           ; SOURCE LINE # 68 
0012 C000    R      PUSH   selectedTemp
0014 C000    R      PUSH   selectedTemp+01H
0016 C000    R      PUSH   selectedTemp+02H
0018 C000    R      PUSH   selectedTemp+03H
001A C000    R      PUSH   maxTemp
001C C000    R      PUSH   maxTemp+01H
001E C000    R      PUSH   maxTemp+02H
0020 C000    R      PUSH   maxTemp+03H
0022 AC00    R      MOV    R4,step
0024 AD00    R      MOV    R5,step+01H
0026 AE00    R      MOV    R6,step+02H
0028 AF00    R      MOV    R7,step+03H
002A 120000  R      LCALL  ?SUBBIEEE
002D 120000  R      LCALL  ?COMPIEEE
0030 BF0102         CJNE   R7,#001H,?LAB11
0033 801B           SJMP   ?WHILE5
0035         ?LAB11:
RC51 COMPILER V03.08.10.309,  HEIZUNGSSYSTEM     09/20/21  10:50:53  PAGE  5

                                           ; SOURCE LINE # 70 
0035 C000    R      PUSH   selectedTemp
0037 C000    R      PUSH   selectedTemp+01H
0039 C000    R      PUSH   selectedTemp+02H
003B C000    R      PUSH   selectedTemp+03H
003D AC00    R      MOV    R4,step
003F AD00    R      MOV    R5,step+01H
0041 AE00    R      MOV    R6,step+02H
0043 AF00    R      MOV    R7,step+03H
0045 120000  R      LCALL  ?ADDIEEE
0048 8C00    R      MOV    selectedTemp,R4
004A 8D00    R      MOV    selectedTemp+01H,R5
004C 8E00    R      MOV    selectedTemp+02H,R6
004E 8F00    R      MOV    selectedTemp+03H,R7
0050         ?WHILE5:
                                           ; SOURCE LINE # 72 
0050 30B1FD         JNB    P3_1,?WHILE5
0053         ?NXT10:
                                           ; SOURCE LINE # 75 
0053 20B241         JB     P3_2,?NXT13
                                           ; SOURCE LINE # 77 
0056 C000    R      PUSH   selectedTemp
0058 C000    R      PUSH   selectedTemp+01H
005A C000    R      PUSH   selectedTemp+02H
005C C000    R      PUSH   selectedTemp+03H
005E C000    R      PUSH   step
0060 C000    R      PUSH   step+01H
0062 C000    R      PUSH   step+02H
0064 C000    R      PUSH   step+03H
0066 AC00    R      MOV    R4,minTemp
0068 AD00    R      MOV    R5,minTemp+01H
006A AE00    R      MOV    R6,minTemp+02H
006C AF00    R      MOV    R7,minTemp+03H
006E 120000  R      LCALL  ?ADDIEEE
0071 120000  R      LCALL  ?COMPIEEE
0074 BFFF02         CJNE   R7,#0FFH,?LAB13
0077 801B           SJMP   ?WHILE6
0079         ?LAB13:
                                           ; SOURCE LINE # 79 
0079 C000    R      PUSH   selectedTemp
007B C000    R      PUSH   selectedTemp+01H
007D C000    R      PUSH   selectedTemp+02H
007F C000    R      PUSH   selectedTemp+03H
0081 AC00    R      MOV    R4,step
0083 AD00    R      MOV    R5,step+01H
0085 AE00    R      MOV    R6,step+02H
0087 AF00    R      MOV    R7,step+03H
0089 120000  R      LCALL  ?SUBBIEEE
008C 8C00    R      MOV    selectedTemp,R4
008E 8D00    R      MOV    selectedTemp+01H,R5
0090 8E00    R      MOV    selectedTemp+02H,R6
0092 8F00    R      MOV    selectedTemp+03H,R7
0094         ?WHILE6:
                                           ; SOURCE LINE # 81 
0094 30B2FD         JNB    P3_2,?WHILE6
0097         ?NXT13:
                                           ; SOURCE LINE # 86 
0097 30B303         JNB    P3_3,$ + 6
RC51 COMPILER V03.08.10.309,  HEIZUNGSSYSTEM     09/20/21  10:50:53  PAGE  6

009A 020000  R      LJMP   ?WHILE4
                                           ; SOURCE LINE # 88 
009D E500    R      MOV    A,systemStatus
009F 24FF           ADD    A,#0FFH
00A1 B3             CPL    C
00A2 E4             CLR    A
00A3 33             RLC    A
00A4 F500    R      MOV    systemStatus,A
00A6         ?WHILE7:
                                           ; SOURCE LINE # 89 
00A6 30B3FD         JNB    P3_3,?WHILE7
00A9 020000  R      LJMP   ?WHILE4

            ; FUNCTION main (END)

RC51 COMPILER V03.08.10.309,  HEIZUNGSSYSTEM     09/20/21  10:50:53  PAGE  8



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    289    ----
   CONSTANT SIZE    =     41    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     41    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

RC51 COMPILATION COMPLETE.  0 WARNING,  0 ERROR
